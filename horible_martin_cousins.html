<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Horrible Martin Cousins</title>
<style>
  body, html {
    margin: 0; padding: 0; height: 100%;
    background: #111;
    color: #eee;
    font-family: monospace, monospace;
    display: flex; justify-content: center; align-items: center;
    flex-direction: column;
  }
  #splash {
    font-size: 2em;
    margin-top: 20vh;
    text-align: center;
  }
  #emulator {
    width: 512px;
    height: 480px;
    display: none;
    margin-top: 2rem;
  }
</style>
</head>
<body>

<div id="splash">
  Welcome to <b>Horrible Martin Cousins!</b><br />
  To play, please insert <b>$100,000</b>.<br />
  Loading in <span id="countdown">4</span>...
</div>

<div id="emulator"></div>

<script src="https://cdn.jsdelivr.net/npm/emulatorjs@0.2.2/dist/emulator.min.js"></script>
<script>
  const splash = document.getElementById('splash');
  const countdownElem = document.getElementById('countdown');
  const emulatorContainer = document.getElementById('emulator');

  let countdown = 4;
  let countdownInterval = setInterval(() => {
    countdown--;
    if (countdown <= 0) {
      clearInterval(countdownInterval);
      splash.style.display = 'none';
      emulatorContainer.style.display = 'block';
      startEmulator();
    } else {
      countdownElem.textContent = countdown;
    }
  }, 1000);

  function startEmulator() {
    const emulator = new EmulatorJS({
      container: emulatorContainer,
      system: 'nes',
      bios: null,
      romUrl: '/martin.definitely_not_a_nes_rom.nes'
    });

    emulator.loadROM()
      .then(() => {
        console.log('ROM loaded and emulator started!');
      })
      .catch(err => {
        console.error('Failed to load ROM:', err);
        alert('Failed to load ROM! Check console.');
      });
  }
</script>

</body>
</html>
